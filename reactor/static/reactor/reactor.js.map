{
  "version": 3,
  "file": "reactor.js",
  "sourceRoot": "../../..",
  "sources": [
    "reactor/static/reactor/reactor.coffee"
  ],
  "names": [],
  "mappings": "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",
  "sourcesContent": [
    "origin = new Date()\n\n\nclass ReactorChannel\n  constructor: (@url='/__reactor__', @retry_interval=100) ->\n    @online = false\n    @callbacks = {}\n    @original_retry_interval = @retry_interval\n\n  on: (event_name, callback) =>\n    @callbacks[event_name] = callback\n\n  trigger: (event_name, args  ...) ->\n    @callbacks[event_name]?(args...)\n\n  open: ->\n    if @retry_interval < 10000\n      @retry_interval += 1000\n\n    if navigator.onLine\n      @websocket?.close()\n\n      if window.location.protocol is 'https:'\n        protocol = 'wss://'\n      else\n        protocol = 'ws://'\n      @websocket = new WebSocket \"#{protocol}#{window.location.host}#{@url}\"\n      @websocket.onopen = (event) =>\n        @online = true\n        @trigger 'open', event\n        @retry_interval = @original_retry_interval\n\n      @websocket.onclose = (event) =>\n        @online = false\n        @trigger 'close', event\n        setTimeout (=> @open()), @retry_interval or 0\n\n      @websocket.onmessage = (event) =>\n        data = JSON.parse event.data\n        @trigger 'message', data\n    else\n      setTimeout (=> @open()), @retry_interval\n\n  send: (command, payload) ->\n    data =\n      command: command\n      payload: payload\n    if @online\n      @websocket.send JSON.stringify data\n\n  send_join: (tag_name, state) ->\n    console.log '>>> JOIN', tag_name, state\n    @send 'join',\n      tag_name: tag_name\n      state: state\n\n  send_leave: (id) ->\n    console.log '>>> LEAVE', id\n    @send 'leave', id: id\n\n  send_user_event: (element, name, args) ->\n    console.log '>>> USER_EVENT', element.tag_name, name, args\n    origin = new Date()\n    if @online\n      @send 'user_event',\n        id: element.id\n        name: name\n        args: args\n\n  reconnect: ->\n    @retry_interval = 0\n    @websocket?.close()\n\n  close: ->\n    console.log 'CLOSE'\n    @websocket?.close()\n\n\n\nreactor_channel = new ReactorChannel()\n\n\nreactor_channel.on 'open', ->\n  console.log 'ON-LINE'\n  for el in document.querySelectorAll '[is]'\n    el.classList.remove('reactor-disconnected')\n    el.connect?()\n\nreactor_channel.on 'close', ->\n  console.log 'OFF-LINE'\n  for el in document.querySelectorAll '[is]'\n    el.classList.add('reactor-disconnected')\n\n\nreactor_channel.on 'message', ({type, id, html_diff, url, component_types}) ->\n  console.log '<<<', type.toUpperCase(), id or url or component_types\n  if type is 'components'\n    declare_components(component_types)\n  else if type is 'redirect'\n    window.location.assign url\n  else if type is 'push_state'\n    reactor.push_state url\n  else\n    el = document.getElementById(id)\n    if el?\n      if type is 'render'\n        el.apply_diff(html_diff)\n      else if type is 'remove'\n        window.requestAnimationFrame ->\n          el.remove()\n\n\nTRANSPILER_CACHE = {}\n\ntranspile = (el) ->\n  if el.attributes is undefined\n    return\n\n  replacements = []\n  for attr in el.attributes\n    if attr.name.startsWith('@')\n      [name, ...modifiers] = attr.name.split('.')\n      start = attr.value.indexOf(' ')\n      if start isnt -1\n        method_name = attr.value[...start]\n        method_args = attr.value[start + 1...]\n      else\n        method_name = attr.value\n        method_args = 'null'\n\n      cache_key = \"#{modifiers}.#{method_name}.#{method_args}\"\n      code = TRANSPILER_CACHE[cache_key]\n      if not code\n        if method_name is ''\n          code = ''\n        else\n          code = \"reactor.send(event.target, '#{method_name}', #{method_args});\"\n\n        while modifiers.length\n          modifier = modifiers.pop()\n          modifier = if modifier is 'space' then ' ' else modifier\n          switch modifier\n            when 'inlinejs'\n              code = attr.value\n            when 'debounce'\n              _name = modifiers.pop()\n              _delay = modifiers.pop()\n              code = \"reactor.debounce('#{_name}', #{_delay})(function(){ #{code} })()\"\n            when 'prevent'\n              code = \"event.preventDefault(); \" + code\n            when 'stop'\n              code = \"event.stopPropagation(); \" + code\n            when 'ctrl'\n              code = \"if (event.ctrlKey) { #{code} }\"\n            when 'alt'\n              code = \"if (event.altKey) { #{code} }\"\n            else\n              code = \"if (event.key.toLowerCase() == '#{modifier}') { #{code} }; \"\n        TRANSPILER_CACHE[cache_key] = code\n\n      replacements.push {\n        old_name: attr.name\n        name: 'on' + name[1...]\n        code: code\n      }\n\n  for {old_name, name, code} in replacements\n      if old_name\n        el.attributes.removeNamedItem old_name\n      nu_attr = document.createAttribute name\n      nu_attr.value = code\n      el.attributes.setNamedItem nu_attr\n\n\ndeclare_components = (component_types) ->\n  for component_name, base_html_element of component_types\n    if customElements.get(component_name)\n      continue\n\n    base_element = document.createElement base_html_element\n    class Component extends base_element.constructor\n      constructor: (...args) ->\n        super(...args)\n        @tag_name = @getAttribute 'is'\n        @_last_received_html = []\n\n      state: -> JSON.parse @getAttribute 'state'\n\n      connectedCallback: ->\n        eval @getAttribute 'onreactor-init'\n        @deep_transpile()\n        @connect()\n\n      disconnectedCallback: ->\n        eval @getAttribute 'onreactor-leave'\n        reactor_channel.send_leave @id\n\n      deep_transpile: (element=null) ->\n        if not element?\n          transpile this\n          element = this\n        for child in element.children\n          transpile child\n          code = child.getAttribute 'onreactor-init'\n          if code\n            (-> eval code).bind(child)()\n          @deep_transpile(child)\n\n      is_root: -> not @parent_component()\n\n      parent_component: ->\n        return @parentElement?.closest('[is]')\n\n      connect: ->\n        if @is_root()\n          reactor_channel.send_join @tag_name, @state()\n\n      apply_diff: (html_diff) ->\n        console.log \"#{new Date() - origin}ms\"\n        html = []\n        cursor = 0\n        for diff in html_diff\n          if typeof diff is 'string'\n            html.push diff\n          else if diff < 0\n            cursor -= diff\n          else\n            html.push(...@_last_received_html[cursor...cursor + diff])\n            cursor += diff\n        @_last_received_html = html\n        html = html.join ' '\n        window.requestAnimationFrame =>\n          morphdom this, html,\n            onBeforeElUpdated: (from_el, to_el) =>\n              # Prevent object from being updated\n              if from_el.hasAttribute(':once')\n                return false\n\n              if from_el.hasAttribute(':keep')\n                to_el.value = from_el.value\n                to_el.checked = from_el.checked\n\n              transpile(to_el)\n\n              should_patch = (\n                from_el is document.activeElement and\n                from_el.tagName in ['INPUT', 'SELECT', 'TEXTAREA'] and\n                not from_el.hasAttribute(':override')\n              )\n              if should_patch\n                to_el.getAttributeNames().forEach (name) ->\n                  from_el.setAttribute(name, to_el.getAttribute(name))\n                from_el.readOnly = to_el.readOnly\n                return false\n\n              return true\n            onElUpdated: (el) ->\n              code = el.getAttribute?('onreactor-updated')\n              if code\n                (-> eval code).bind(el)()\n            onNodeAdded: (el) ->\n              transpile el\n              code = el.getAttribute?('onreactor-added')\n              if code\n                (-> eval code).bind(el)()\n\n          @querySelector('[\\\\:focus]:not([disabled])')?.focus()\n\n      dispatch: (name, form, args) ->\n        args = merge_objects (@serialize form or this), args\n        reactor_channel.send_user_event(this, name, args)\n\n      serialize: (form) ->\n        # Serialize the fields with name attribute and creates a dictionary\n        # with them. It support nested name spaces.\n        #\n        # Ex1:\n        #   <input name=\"a\" value=\"q\">\n        #   <input name=\"b\" value=\"x\">\n        # Result: {a: \"q\", b: \"x\"}\n        #\n        # Ex2:\n        #   <input name=\"query\" value=\"q\">\n        #   <input name=\"person.name\" value=\"John\">\n        #   <input name=\"person.age\" value=\"99\">\n        # Result: {query: \"q\", person: {name: \"John\", value: \"99\"}}\n        #\n        # Ex3:\n        #   <input name=\"query\" value=\"q\">\n        #   <input name=\"persons[].name\" value=\"a\">\n        #   <input name=\"persons[].name\" value=\"b\">\n        # Result: {query: \"q\", persons: [{name: \"a\"}, {name: \"b\"}]}\n\n        state = {}\n        for el in form.querySelectorAll('[name]')\n          if el.closest('[is]') is this\n            value = (\n              if el.type.toLowerCase() is 'checkbox'\n                if el.checked\n                  el.getAttribute('value') or true\n                else\n                  null\n              else if el.type.toLowerCase() is 'radio'\n                if el.checked\n                  el.value or true\n                else\n                  null\n              else if el.type.toLowerCase() is 'select-multiple'\n                (option.value for option in el.selectedOptions)\n              else if el.hasAttribute 'contenteditable'\n                if el.hasAttribute ':as-text'\n                  el.innerText\n                else\n                  el.innerHTML.trim()\n              else\n                el.value\n            )\n            if value is null\n              continue\n            for part in el.getAttribute('name').split('.').reverse()\n              obj = {}\n              if part.endsWith('[]')\n                obj[part[...-2]] = [value]\n              else\n                obj[part] = value\n              value = obj\n            state = merge_objects state, value\n        state\n\n      merge_objects = (target, source) ->\n        for k, v of source\n          target_value = target[k]\n          if Array.isArray target_value\n            target_value.push v...\n          else if typeof target_value is 'object'\n            merge_objects target_value, v\n          else\n            target[k] = v\n        target\n\n    customElements.define(component_name, Component, extends: base_html_element)\n\nwindow.reactor = reactor = {}\n\nreactor.send = (element, name, args) ->\n  component = element.closest('[is]')\n  form = element.closest('form')\n  if component?\n    form = if component.contains(form) then form else null\n    component.dispatch(name, form, args)\n\n_timeouts = {}\n\nreactor.debounce = (delay_name, delay) -> (f) -> (...args) ->\n  clearTimeout _timeouts[delay_name]\n  _timeouts[delay_name] = setTimeout (=> f(...args)), delay\n\nreactor.push_state = (url) ->\n  if Turbolinks?\n    Turbolinks.visit url\n  else\n    window.location.assign url\n\nreactor_channel.open()\n\n"
  ]
}